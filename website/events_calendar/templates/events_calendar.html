{% extends 'base.html' %}
{% block title%}Events{% endblock %}
{% block events_calendar_active %} active {% endblock %}
{% load widget_tweaks %}
{% block content %}
<style>
  /* .center {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
} */
/* input {
    position: absolute;
    opacity: 0;
    z-index: -1;
} */
.inp{
  position: absolute;
  opacity: 0;
  z-index: -1;
}
.accordion-wrapper {
    border-radius: 8px;
    overflow: hidden;
    box-shadow: 0 4px 4px -2px rgba(0, 0, 0, 0.5);
     margin:0 auto;
}
.accordion {
    width: 100%;
    color: white;
    overflow: hidden;
    margin-bottom: 0px;
}
.accordion:last-child{
    margin-bottom: 0;
}
.accordion-label {
    display: flex;
    -webkit-box-pack: justify;
    justify-content: space-between;
    padding: 12px 20px;
    background: #6C757D;
    cursor: pointer;
    font-size: 20px;
}
.accordion-label:hover {
    background: #6C757D;
}
.accordion-label::after {
    width: 16px;
    height: 10px;
    text-align: center;
    -webkit-transition: all 0.3s;
    transition: all 0.3s;
}
.accordion-content {
    max-height: 0;
    padding: 0 12px;
    color:#6C757D;
    background: white;
    -webkit-transition: all 0.3s;
    transition: all 0.3s;
}
.accordion-content p{
    margin: 0;
    color: rgba(4,57,94,.7);
    font-size: 20px;
}
input:checked + .accordion-label {
    background:#6C757D;
}
input:checked + .accordion-label::after {
    -webkit-transform: rotate(90deg);
    transform: rotate(90deg);
}
input:checked ~ .accordion-content {
    max-height: 100vh;
    padding: 16px;
}

.highlight_filter{
    background-color: #6C757D;
    color: white;
}
  
</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css"
integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog=="
crossorigin="anonymous" />
<div class="container">
  <a href="{% url 'home' %}" class="text-muted" style="font-size: small;">< Back to Home</a>
  <h2 style="margin-top: 2%">Events</h2>
  <link href="https://fonts.googleapis.com/css?family=Pacifico&display=swap" rel="stylesheet">
  <p class="small" style="font-family: 'Pacifico', cursive;">We don't remember the dates, we remember events!</p>
  <div class="row">
    <div class="col-lg-9 col-sm-12 mt-2">
      <div class="card ml-0"  style="transform: none; transition: none; box-shadow: none;">
        <div class="block row card-header m-0">
          <div  class="col-sm-12 col-lg-7 ">
            <div class="btn-group col-sm-12 col-md-6 col-lg-5" role="group" >
              {% if 'All' in request.path or 'filter' not in request.path and 'search' not in request.path %}
                <a class="btn btn-outline-secondary btn-md mt-1 highlight_filter" href="{% url 'events_calendar:list_events' %}" style="text-decoration: none;">All</a>
              {% else %}
                <a class="btn btn-outline-secondary btn-md mt-1 " href="{% url 'events_calendar:list_events' %}" style="text-decoration: none;">All</a>
              {% endif %}
              {% if 'Class' in request.path %}
                <a class="btn btn-outline-secondary btn-md mt-1 highlight_filter" href="{% url 'events_calendar:filter_event' 'Class'  %}" style="text-decoration: none;">Classes</a>
              {% else %}
                <a class="btn btn-outline-secondary btn-md mt-1 " href="{% url 'events_calendar:filter_event' 'Class'  %}" style="text-decoration: none;">Classes</a>
              {% endif %}
              {% if 'Contest' in request.path %}
                <a class="btn btn-outline-secondary btn-md mt-1 highlight_filter"href="{% url 'events_calendar:filter_event' 'Contest'  %}"  style="text-decoration: none;">Contests</a>
                {% else %}
                <a class="btn btn-outline-secondary btn-md mt-1 " href="{% url 'events_calendar:filter_event' 'Contest'  %}" style="text-decoration: none;">Contests</a>
              {% endif %}
              {% if 'Event' in request.path %}
                <a class="btn btn-outline-secondary btn-md mt-1 highlight_filter"href="{% url 'events_calendar:filter_event' 'Event'  %}"  style="text-decoration: none;">Events</a>
                {% else %}
                <a class="btn btn-outline-secondary btn-md mt-1 " href="{% url 'events_calendar:filter_event' 'Event'  %}" style="text-decoration: none;">Events</a>
              {% endif %}
            </div>
          
          </div>
          
          <div class="col-sm-12 col-lg-5">
            <form method="POST">
              <div class="mt-1 mb-1">
                {% csrf_token %}
                {% render_field form_search.key class="form-control mr-1" placeholder="Search" style="display:inline-block;min-width:150px; max-width:20vw;" %}  
                <button type="submit" class="save btn btn-sm btn-outline-primary" style="display: inline-block;"> <i class="fas fa-search"></i></button>
              </div>
            </form>
          </div>          
       </div>
       {% if perms == True %}
       <a class="btn" href="{% url 'events_calendar:create_event' %}" style="float:right">
         <button type="button" class="btn btn-primary w-100 btn-sm">
           Add Event&nbsp;&nbsp;<i class="far fa-edit"></i>
         </button>
       </a>
     {% endif %}

    
  <div id="events-list">
    {% include 'events_list.html' %}
  </div>
</div>
    </div>
    <!-- Code for Year wise count of events -->
    <!-- <div class="col-sm-12 col-lg-3 mt-2" >
    <div class="ml-0">
      <div class=" mr-auto">
        <div class="card" style="transform: none; transition: none; box-shadow: none;">
          <div class="accordion-wrapper mt-3" style="transform: none; transition: none; box-shadow: none;">
            <div class="accordion">
              <input class="inp" type="radio" name="radio-a" id="check4" checked>
              <label class="accordion-label" for="check4">Events Organized</label>
            </div>
            {% for key,value in events_count.items %}
            <div class="accordion-wrapper" style="transform: none; transition: none; box-shadow: none;">
            <div class="accordion">
              <input class="inp" type="radio" name="radio-a" id={{key}}>
              <label class="accordion-label" for={{key}} style="text-align: center;">{{key}}</label>
              <div class="accordion-content">
                <p style="text-align: center;"><strong>{{value}}</strong></p>
              </div>
            </div>
          </div>
          {% endfor %}
          </div>
        </div>
      </div>

  </div>
    </div> -->
    <!-- <div class="col-sm-12 col-lg-3 mt-2">
      <div class="ml-0">
        <div class=" mr-auto">
          <div class="card" style="transform: none; transition: none; box-shadow: none;">
              <div class="number card-header  p-0"><h4 style="text-align:center;">
                <p class="ml-auto mr-auto mb-0 mt-2" style="font-family:'Rajdhani',sans-serif;">Events Organized</p></h4>
              </div>
                {% for key,value in events_count.items %}
                <div class="number card-header  p-2"><h6 style="text-align:center;">
                  <p class="ml-auto mr-auto mb-0 mt-2">{{ key }} - {{value}}</p></h6>
                </div>
              {% endfor %}
            </h3>
            </div>
          </div>
        </div>
      </div> -->

      <div class="col-sm-12 col-lg-3 mt-2">
        <div class="ml-0">
          <div class=" mr-auto">
            {% for key, value in events_count.items %}
            {% if key == 'Total' %}
            <div class="card" style="transform: none; transition: none; box-shadow: none;">
              <div class="number card-header  p-0"><h2 style="text-align:center;">
                <p class="ml-auto mr-auto mb-0 mt-2" style="font-family:'Rajdhani',sans-serif;">{{ value }}</p></h2>
              </div>
              <div class="mt-2">
                <p style="text-align: center;">Events Organized</p>
              </div>
            </div>
            {% else %}
            <div class="card" style="transform: none; transition: none; box-shadow: none;">
                <div class="number card-header  p-0"><h2 style="text-align:center;">
                  <p class="ml-auto mr-auto mb-0 mt-2" style="font-family:'Rajdhani',sans-serif;">{{ value }}</p></h2>
                </div>
                <div class="mt-2">
                  <p style="text-align: center;">In {{ key }}</p>
                </div>
              </div>
              {% endif %}
              {% endfor %}
            </div>
          </div>
        </div>

  </div>
</div>

  {% endblock %}

  {% block js %}
  <!-- Import Google Fonts-->
  <link href="https://fonts.googleapis.com/css?family=Ubuntu:400,700" rel="stylesheet">
  
  <!-- Import Google Font Montserrat -->
  <link href="https://fonts.googleapis.com/css?family=Montserrat:100,100i,200,200i,300,300i,400,400i,500,500i,600,600i,700,700i,800,800i,900,900i" rel="stylesheet">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
  <script>
    var page = 1;
    var empty_page = false;
    var block_request = false;
  
    $(window).scroll(function() {
      var margin = $(document).height() - $(window).height();
      if ($(window).scrollTop() > margin && empty_page == false && block_request == false)
        block_request = true;
      page += 1;
      $.get('?page=' + page, function(data) {
        if (data == '') {
          empty_page = true;
        } else {
          $('#events-list').append(data);
        }
      });
    });
  </script>
  {% endblock js %}